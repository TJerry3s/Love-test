<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="æ‹çˆ±å€¾å‘æµ‹è¯•â€”â€”æ¢ç´¢ä½ çš„æ‹çˆ±é£æ ¼">
    <title>æ‹çˆ±å€¾å‘æµ‹è¯•</title>

    <!-- DNSé¢„è§£æ -->
    <link rel="dns-prefetch" href="https://unpkg.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

    <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
    <link rel="preload" href="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" as="script">

    <!-- Vue 3 - ä½¿ç”¨æ›´å¿«çš„CDN -->
    <script src="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js"></script>

    <!-- html2canvas - å»¶è¿ŸåŠ è½½ -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB',
                'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8E53 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        #app {
            max-width: 800px;
            margin: 0 auto;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(255, 107, 157, 0.3);
            padding: 30px;
            min-height: 500px;
        }

        /* é¦–é¡µæ ·å¼ */
        .home-page {
            text-align: center;
        }

        .logo {
            font-size: 48px;
            margin-bottom: 20px;
        }

        h1 {
            color: #FF6B9D;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .info-card {
            background: #FFF5F8;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
            border-left: 4px solid #FF6B9D;
        }

        .info-card h3 {
            color: #FF6B9D;
            margin-bottom: 10px;
        }

        .info-card ul {
            padding-left: 20px;
        }

        .info-card li {
            margin: 8px 0;
            line-height: 1.6;
        }

        .btn {
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8E53 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 157, 0.6);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #FFA726 0%, #FF7043 100%);
        }

        .btn-small {
            padding: 8px 20px;
            font-size: 14px;
            margin: 5px;
        }

        /* æµ‹è¯•é¡µé¢æ ·å¼ */
        .test-page {
            padding: 20px 0;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 8px;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #FF6B9D 0%, #FF8E53 100%);
            height: 100%;
            transition: width 0.3s;
        }

        .progress-text {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .question-card {
            margin: 30px 0;
        }

        .question-number {
            color: #FF6B9D;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 24px;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #333;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            background: #FFF5F8;
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .option:hover {
            background: #FFE0EC;
            border-color: #FF6B9D;
        }

        .option.selected {
            background: linear-gradient(135deg, #FF6B9D15 0%, #FF8E5315 100%);
            border-color: #FF6B9D;
        }

        .option-value {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8E53 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }

        .option-label {
            font-size: 18px;
            font-weight: bold;
            margin-right: 10px;
        }

        .option-description {
            color: #666;
            font-size: 14px;
        }

        .navigation {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }

        /* ç»“æœé¡µé¢æ ·å¼ */
        .result-page {
            padding: 20px 0;
        }

        .result-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .result-main-title {
            font-size: 28px;
            font-weight: bold;
            color: #FF6B9D;
            margin-bottom: 10px;
        }

        .result-subtitle {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }

        .result-time {
            color: #999;
            font-size: 14px;
        }

        /* ä¸»è¦æ‹çˆ±ç±»å‹å¡ç‰‡ */
        .main-type-card {
            background: linear-gradient(135deg, #FFF5F8 0%, #FFE0EC 100%);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            border: 2px solid #FF6B9D;
        }

        .type-emoji {
            font-size: 64px;
            margin-bottom: 15px;
        }

        .type-name {
            font-size: 32px;
            font-weight: bold;
            color: #FF6B9D;
            margin-bottom: 10px;
        }

        .type-tagline {
            font-size: 18px;
            color: #FF8E53;
            font-style: italic;
            margin-bottom: 20px;
        }

        .type-badge {
            display: inline-block;
            padding: 10px 25px;
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8E53 100%);
            color: white;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
        }

        /* é›·è¾¾å›¾åŒºåŸŸ */
        .radar-section {
            margin: 30px 0;
        }

        .radar-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .radar-chart {
            width: 300px;
            height: 300px;
        }

        /* ç»´åº¦å¾—åˆ†è¡¨æ ¼ */
        .dimension-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: 20px 0;
        }

        .dimension-table th {
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8E53 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
        }

        .dimension-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
            font-size: 16px;
        }

        .dimension-table tr:last-child td {
            border-bottom: none;
        }

        .level-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: bold;
        }

        .level-high {
            background: #FFCDD2;
            color: #C62828;
        }

        .level-medium {
            background: #FFE0B2;
            color: #EF6C00;
        }

        .level-low {
            background: #E0E0E0;
            color: #616161;
        }

        /* ç±»å‹è¯¦ç»†è§£è¯» */
        .analysis-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .analysis-title {
            font-size: 20px;
            font-weight: bold;
            color: #FF6B9D;
            margin-bottom: 20px;
            text-align: center;
        }

        .analysis-block {
            margin-bottom: 20px;
        }

        .analysis-block h4 {
            color: #FF8E53;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .analysis-block ul {
            padding-left: 20px;
        }

        .analysis-block li {
            margin: 8px 0;
            line-height: 1.6;
        }

        /* å»ºè®®åŒºåŸŸ */
        .suggestion-section {
            background: #FFF5F8;
            border-left: 4px solid #FF6B9D;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .suggestion-section h3 {
            color: #FF6B9D;
            margin-bottom: 15px;
        }

        .suggestion-block {
            margin-bottom: 15px;
        }

        .suggestion-label {
            display: inline-block;
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8E53 100%);
            color: white;
            padding: 3px 10px;
            border-radius: 5px;
            font-size: 14px;
            margin-right: 8px;
        }

        .suggestion-text {
            line-height: 1.8;
            color: #333;
        }

        /* åŒ¹é…ç±»å‹åŒºåŸŸ */
        .match-section {
            background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .match-title {
            font-size: 20px;
            font-weight: bold;
            color: #1976D2;
            margin-bottom: 20px;
        }

        .match-types {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .match-type-badge {
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            color: #1976D2;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(25, 118, 210, 0.2);
        }

        .match-description {
            color: #1976D2;
            line-height: 1.6;
            margin-top: 15px;
        }

        .match-stars {
            color: #FFC107;
            font-size: 18px;
            margin: 10px 0;
        }

        /* åˆ†äº«åŒºåŸŸ */
        .share-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e0e0e0;
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            text-align: center;
            padding: 60px 40px;
            color: #666;
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FF6B9D;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            font-size: 18px;
            margin-top: 20px;
            color: #FF6B9D;
            font-weight: 500;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 20px;
            }

            h1 {
                font-size: 24px;
            }

            .question-text {
                font-size: 20px;
            }

            .option {
                padding: 12px 15px;
            }

            .option-label {
                font-size: 16px;
            }

            .type-name {
                font-size: 24px;
            }

            .radar-chart {
                width: 250px;
                height: 250px;
            }

            .dimension-table th,
            .dimension-table td {
                padding: 10px 5px;
                font-size: 14px;
            }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s;
        }

        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }

        .slide-enter-active, .slide-leave-active {
            transition: all 0.3s;
        }

        .slide-enter-from {
            transform: translateX(30px);
            opacity: 0;
        }

        .slide-leave-to {
            transform: translateX(-30px);
            opacity: 0;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <!-- åŠ è½½ä¸­ -->
            <div v-if="loading" class="loading">
                <div class="loading-spinner"></div>
                <p>æ­£åœ¨åŠ è½½ï¼Œè¯·ç¨å€™...</p>
            </div>

            <!-- é¦–é¡µ -->
            <div v-else-if="currentPage === 'home'" class="home-page">
                <div class="logo">ğŸ’•</div>
                <h1>æ‹çˆ±å€¾å‘æµ‹è¯•</h1>
                <p class="subtitle">æ¢ç´¢ä½ çš„æ‹çˆ±é£æ ¼ï¼Œå‘ç°æœ€é€‚åˆä½ çš„ç›¸å¤„æ¨¡å¼</p>

                <div class="info-card">
                    <h3>ğŸ“‹ æµ‹è¯•è¯´æ˜</h3>
                    <ul>
                        <li>æœ¬æµ‹è¯•åŒ…å« 20 é“é¢˜ç›®ï¼Œé¢„è®¡éœ€è¦ 3-5 åˆ†é’Ÿå®Œæˆ</li>
                        <li>è¯·æ ¹æ®æ‚¨çš„<strong>çœŸå®æƒ³æ³•å’Œæ„Ÿå—</strong>ä½œç­”</li>
                        <li>æ¯é¢˜æœ‰ 5 ä¸ªé€‰é¡¹ï¼Œé€‰æ‹©æœ€ç¬¦åˆæ‚¨æƒ…å†µçš„é€‰é¡¹</li>
                        <li>æµ‹è¯•ç»“æœä»…ä¾›å¨±ä¹å’Œè‡ªæˆ‘æ¢ç´¢å‚è€ƒ</li>
                    </ul>
                </div>

                <div class="info-card">
                    <h3>ğŸŒŸ æµ‹è¯•ç»´åº¦</h3>
                    <ul>
                        <li><strong>æ¿€æƒ…å‹</strong>ï¼šå¯¹å¿ƒåŠ¨ä½“éªŒå’Œæµªæ¼«çš„é‡è§†ç¨‹åº¦</li>
                        <li><strong>ç†æ™ºå‹</strong>ï¼šå¯¹ç°å®æ¡ä»¶å’Œç†æ€§è§„åˆ’çš„é‡è§†ç¨‹åº¦</li>
                        <li><strong>å¥‰çŒ®å‹</strong>ï¼šæ„¿æ„ä¸ºå¯¹æ–¹ä»˜å‡ºçš„ç¨‹åº¦</li>
                        <li><strong>ä¾èµ–å‹</strong>ï¼šå¯¹æƒ…æ„Ÿé™ªä¼´å’Œä¾èµ–çš„éœ€æ±‚ç¨‹åº¦</li>
                        <li><strong>ç‹¬ç«‹å‹</strong>ï¼šä¿æŒè‡ªæˆ‘ç©ºé—´å’Œç‹¬ç«‹æ€§çš„éœ€æ±‚ç¨‹åº¦</li>
                    </ul>
                </div>

                <div class="info-card">
                    <h3>ğŸ”’ éšç§ä¿æŠ¤</h3>
                    <ul>
                        <li>æ‚¨çš„æµ‹è¯•æ•°æ®ä»…ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­</li>
                        <li>æˆ‘ä»¬ä¸ä¼šæ”¶é›†æˆ–ä¸Šä¼ æ‚¨çš„ä¸ªäººä¿¡æ¯</li>
                    </ul>
                </div>

                <button class="btn" @click="startTest">å¼€å§‹æµ‹è¯•</button>
            </div>

            <!-- æµ‹è¯•é¡µé¢ -->
            <div v-else-if="currentPage === 'test'" class="test-page">
                <div class="progress-bar">
                    <div class="progress-fill" :style="{width: progress + '%'}"></div>
                </div>
                <div class="progress-text">
                    ç¬¬ {{ currentQuestionIndex + 1 }} é¢˜ / å…± 20 é¢˜
                </div>

                <transition name="slide" mode="out-in">
                    <div :key="currentQuestionIndex" class="question-card">
                        <div class="question-number">é¢˜ç›® {{ currentQuestionIndex + 1 }}</div>
                        <div class="question-text">{{ currentQuestion.text }}</div>

                        <div class="options">
                            <div
                                v-for="option in answerOptions"
                                :key="option.value"
                                class="option"
                                :class="{selected: answers[currentQuestionIndex] === option.value}"
                                @click="selectAnswer(option.value)"
                            >
                                <div class="option-value">{{ option.value }}</div>
                                <div>
                                    <div class="option-label">{{ option.label }}</div>
                                    <div class="option-description">{{ option.description }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </transition>

                <div class="navigation">
                    <button
                        class="btn btn-secondary"
                        @click="previousQuestion"
                        :disabled="currentQuestionIndex === 0"
                    >
                        ä¸Šä¸€é¢˜
                    </button>
                    <button
                        class="btn"
                        @click="nextQuestion"
                        :disabled="!answers[currentQuestionIndex]"
                    >
                        {{ currentQuestionIndex === 19 ? 'æäº¤æµ‹è¯•' : 'ä¸‹ä¸€é¢˜' }}
                    </button>
                </div>
            </div>

            <!-- ç»“æœé¡µé¢ -->
            <div v-else-if="currentPage === 'result'" class="result-page">
                <!-- é¡¶éƒ¨æ ‡é¢˜åŒº -->
                <div class="result-header">
                    <h1 class="result-main-title">ğŸ’• æ‹çˆ±å€¾å‘æµ‹è¯•ç»“æœ</h1>
                    <p class="result-subtitle">æ¢ç´¢ä½ çš„æ‹çˆ±é£æ ¼</p>
                    <p class="result-time">æµ‹è¯•æ—¶é—´ï¼š{{ formatResultTime(result.timestamp) }}</p>
                </div>

                <!-- ä¸»è¦æ‹çˆ±ç±»å‹ -->
                <div class="main-type-card">
                    <div class="type-emoji">{{ result.loveTypeInfo.emoji }}</div>
                    <div class="type-name">ä½ çš„æ‹çˆ±ç±»å‹æ˜¯ï¼š{{ result.loveType }}</div>
                    <div class="type-tagline">{{ result.loveTypeInfo.tagline }}</div>
                    <div class="type-badge">{{ result.loveType }}</div>
                </div>

                <!-- é›·è¾¾å›¾ -->
                <div class="radar-section">
                    <h3 style="text-align: center; color: #FF6B9D; margin-bottom: 15px;">äº”ç»´å€¾å‘åˆ†æ</h3>
                    <div class="radar-container">
                        <svg class="radar-chart" viewBox="0 0 300 300">
                            <defs>
                                <linearGradient id="radarGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#FF6B9D;stop-opacity:0.6" />
                                    <stop offset="100%" style="stop-color:#FF8E53;stop-opacity:0.6" />
                                </linearGradient>
                            </defs>

                            <!-- èƒŒæ™¯äº”è¾¹å½¢ç½‘æ ¼ -->
                            <g v-for="level in 4" :key="level">
                                <polygon
                                    :points="getRadarPoints(level * 4)"
                                    fill="none"
                                    :stroke="level === 4 ? '#FF6B9D' : '#e0e0e0'"
                                    stroke-width="1"
                                />
                            </g>

                            <!-- ç»´åº¦æ ‡ç­¾ -->
                            <text x="150" y="25" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">æ¿€æƒ…å‹</text>
                            <text x="270" y="110" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">ç†æ™ºå‹</text>
                            <text x="235" y="250" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">å¥‰çŒ®å‹</text>
                            <text x="65" y="250" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">ä¾èµ–å‹</text>
                            <text x="30" y="110" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">ç‹¬ç«‹å‹</text>

                            <!-- å¾—åˆ†æ ‡ç­¾ -->
                            <text x="150" y="45" text-anchor="middle" fill="#FF6B9D" font-size="12">{{ result.dimensionScores.æ¿€æƒ…å‹ }}åˆ†</text>
                            <text x="255" y="125" text-anchor="middle" fill="#FF6B9D" font-size="12">{{ result.dimensionScores.ç†æ™ºå‹ }}åˆ†</text>
                            <text x="220" y="235" text-anchor="middle" fill="#FF6B9D" font-size="12">{{ result.dimensionScores.å¥‰çŒ®å‹ }}åˆ†</text>
                            <text x="80" y="235" text-anchor="middle" fill="#FF6B9D" font-size="12">{{ result.dimensionScores.ä¾èµ–å‹ }}åˆ†</text>
                            <text x="50" y="125" text-anchor="middle" fill="#FF6B9D" font-size="12">{{ result.dimensionScores.ç‹¬ç«‹å‹ }}åˆ†</text>

                            <!-- ç”¨æˆ·å¾—åˆ†åŒºåŸŸ -->
                            <polygon
                                :points="getUserRadarPoints()"
                                fill="url(#radarGradient)"
                                stroke="#FF6B9D"
                                stroke-width="2"
                            />
                        </svg>
                    </div>
                </div>

                <!-- ç»´åº¦å¾—åˆ†è¯¦æƒ…è¡¨ -->
                <h3 style="text-align: center; color: #FF6B9D; margin: 30px 0 20px;">ç»´åº¦å¾—åˆ†è¯¦æƒ…</h3>
                <table class="dimension-table">
                    <thead>
                        <tr>
                            <th>ç»´åº¦</th>
                            <th>å¾—åˆ†</th>
                            <th>ç­‰çº§</th>
                            <th>ç±»å‹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(score, dimension) in result.dimensionScores" :key="dimension">
                            <td style="text-align: left; padding-left: 20px;">{{ getDimensionEmoji(dimension) }} {{ dimension }}</td>
                            <td><strong>{{ score }}</strong></td>
                            <td>
                                <span class="level-badge" :class="getDimensionLevel(dimension, score).class">
                                    {{ getDimensionLevel(dimension, score).level }}
                                </span>
                            </td>
                            <td>{{ getDimensionLevel(dimension, score).label }}</td>
                        </tr>
                    </tbody>
                </table>

                <!-- ç±»å‹è¯¦ç»†è§£è¯» -->
                <div class="analysis-section">
                    <h3 class="analysis-title">{{ result.loveTypeInfo.emoji }} {{ result.loveType }}è¯¦ç»†è§£è¯»</h3>

                    <div class="analysis-block">
                        <h4>âœ¨ ç±»å‹ç‰¹å¾</h4>
                        <ul>
                            <li v-for="feature in result.loveTypeInfo.features" :key="feature">{{ feature }}</li>
                        </ul>
                    </div>

                    <div class="analysis-block">
                        <h4>ğŸ’ª ä¼˜ç‚¹</h4>
                        <ul>
                            <li v-for="strength in result.loveTypeInfo.strengths" :key="strength">{{ strength }}</li>
                        </ul>
                    </div>

                    <div class="analysis-block">
                        <h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
                        <ul>
                            <li v-for="weakness in result.loveTypeInfo.weaknesses" :key="weakness">{{ weakness }}</li>
                        </ul>
                    </div>
                </div>

                <!-- æ‹çˆ±å»ºè®® -->
                <div class="suggestion-section">
                    <h3>ğŸ’¡ æ‹çˆ±å»ºè®®</h3>

                    <div class="suggestion-block">
                        <span class="suggestion-label">ğŸ¯ æ‹©å¶å»ºè®®</span>
                        <p class="suggestion-text">{{ result.loveTypeInfo.suggestions.partner }}</p>
                    </div>

                    <div class="suggestion-block">
                        <span class="suggestion-label">ğŸ’• ç›¸å¤„å»ºè®®</span>
                        <p class="suggestion-text">{{ result.loveTypeInfo.suggestions.relationship }}</p>
                    </div>

                    <div class="suggestion-block">
                        <span class="suggestion-label">ğŸŒ± è‡ªæˆ‘æˆé•¿</span>
                        <p class="suggestion-text">{{ result.loveTypeInfo.suggestions.growth }}</p>
                    </div>
                </div>

                <!-- æœ€ä½³åŒ¹é…ç±»å‹ -->
                <div class="match-section">
                    <h3 class="match-title">ğŸ’‘ æœ€ä½³åŒ¹é…ç±»å‹</h3>
                    <div class="match-stars">â˜…â˜…â˜…â˜…â˜†</div>
                    <div class="match-types">
                        <span v-for="matchType in result.loveTypeInfo.matchTypes" :key="matchType" class="match-type-badge">
                            {{ matchType }}
                        </span>
                    </div>
                    <p class="match-description">{{ result.loveTypeInfo.matchDescription }}</p>
                </div>

                <!-- åˆ†äº«åŒºåŸŸ -->
                <div class="share-section">
                    <h3>ğŸ“¤ ä¿å­˜æµ‹è¯•ç»“æœ</h3>
                    <p style="color: #666; margin-bottom: 20px;">
                        æ‚¨å¯ä»¥ä¿å­˜æµ‹è¯•ç»“æœï¼Œéšæ—¶æŸ¥çœ‹æ‚¨çš„æ‹çˆ±å€¾å‘æŠ¥å‘Š
                    </p>

                    <button class="btn" @click="saveResultAsImage" :disabled="savingImage">
                        {{ savingImage ? 'ç”Ÿæˆä¸­...' : (imageSaved ? 'âœ“ å·²ä¿å­˜' : 'ğŸ“· ä¿å­˜ä¸ºå›¾ç‰‡') }}
                    </button>

                    <p style="color: #999; font-size: 12px; margin-top: 15px;">
                        ğŸ’¡ æç¤ºï¼šç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¯å°†æµ‹è¯•ç»“æœä¿å­˜ä¸ºå›¾ç‰‡
                    </p>

                    <button class="btn btn-secondary btn-small" @click="restartTest" style="margin-top: 20px;">
                        ğŸ”„ é‡æ–°æµ‹è¯•
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { questions, answerOptions } from './data/questions.js';
        import { calculateLoveResult, getDimensionLevel } from './utils/calculator.js';

        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    loading: false,

                    // é¡µé¢çŠ¶æ€
                    currentPage: 'home', // home, test, result

                    // æµ‹è¯•æ•°æ®
                    questions,
                    answerOptions,
                    answers: new Array(20).fill(null),
                    currentQuestionIndex: 0,
                    result: null,

                    // ä¿å­˜å›¾ç‰‡çŠ¶æ€
                    savingImage: false,
                    imageSaved: false
                };
            },
            computed: {
                progress() {
                    const answered = this.answers.filter(a => a !== null).length;
                    return (answered / 20) * 100;
                },
                currentQuestion() {
                    return this.questions[this.currentQuestionIndex];
                }
            },
            methods: {
                // å¼€å§‹æµ‹è¯•
                startTest() {
                    this.currentPage = 'test';
                    this.answers = new Array(20).fill(null);
                    this.currentQuestionIndex = 0;
                },

                // é€‰æ‹©ç­”æ¡ˆ
                selectAnswer(value) {
                    this.answers[this.currentQuestionIndex] = value;

                    // å»¶è¿Ÿåè‡ªåŠ¨è·³è½¬
                    setTimeout(() => {
                        if (this.currentQuestionIndex < 19) {
                            this.nextQuestion();
                        }
                    }, 300);
                },

                // ä¸‹ä¸€é¢˜
                nextQuestion() {
                    if (this.currentQuestionIndex < 19) {
                        this.currentQuestionIndex++;
                        // è·³è¿‡å·²å›ç­”çš„é¢˜ç›®
                        while (this.currentQuestionIndex < 19 && this.answers[this.currentQuestionIndex] !== null) {
                            this.currentQuestionIndex++;
                        }
                    } else {
                        this.submitTest();
                    }
                    window.scrollTo(0, 0);
                },

                // ä¸Šä¸€é¢˜
                previousQuestion() {
                    if (this.currentQuestionIndex > 0) {
                        this.currentQuestionIndex--;
                        window.scrollTo(0, 0);
                    }
                },

                // æäº¤æµ‹è¯•
                submitTest() {
                    if (this.answers.some(a => a === null)) {
                        alert('è¯·å®Œæˆæ‰€æœ‰é¢˜ç›®åå†æäº¤');
                        return;
                    }

                    // è®¡ç®—ç»“æœ
                    this.result = calculateLoveResult(this.answers);
                    this.currentPage = 'result';
                    window.scrollTo(0, 0);
                },

                // é‡æ–°æµ‹è¯•
                restartTest() {
                    if (confirm('ç¡®å®šè¦é‡æ–°å¼€å§‹æµ‹è¯•å—ï¼Ÿå½“å‰ç»“æœå°†è¢«æ¸…é™¤ã€‚')) {
                        this.currentPage = 'home';
                        this.answers = new Array(20).fill(null);
                        this.result = null;
                    }
                },

                // ä¿å­˜ç»“æœä¸ºå›¾ç‰‡
                async saveResultAsImage() {
                    try {
                        this.savingImage = true;
                        this.imageSaved = false;

                        const element = document.querySelector('.result-page');

                        const canvas = await html2canvas(element, {
                            scale: 2,
                            useCORS: true,
                            backgroundColor: '#ffffff',
                            logging: false
                        });

                        canvas.toBlob((blob) => {
                            const url = URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.download = `æ‹çˆ±å€¾å‘æµ‹è¯•ç»“æœ_${new Date().toLocaleDateString('zh-CN')}.png`;
                            link.href = url;
                            link.click();

                            URL.revokeObjectURL(url);

                            this.savingImage = false;
                            this.imageSaved = true;

                            setTimeout(() => {
                                this.imageSaved = false;
                            }, 3000);
                        });
                    } catch (error) {
                        console.error('ä¿å­˜å›¾ç‰‡å¤±è´¥:', error);
                        alert('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•æˆ–ä½¿ç”¨æˆªå›¾å·¥å…·ä¿å­˜');
                        this.savingImage = false;
                        this.imageSaved = false;
                    }
                },

                // æ ¼å¼åŒ–ç»“æœæ—¶é—´
                formatResultTime(timestamp) {
                    if (!timestamp) return '';
                    const date = new Date(timestamp);
                    return date.toLocaleString('zh-CN');
                },

                // è·å–ç»´åº¦ç­‰çº§
                getDimensionLevel(dimension, score) {
                    return getDimensionLevel(dimension, score);
                },

                // è·å–ç»´åº¦emoji
                getDimensionEmoji(dimension) {
                    const emojis = {
                        æ¿€æƒ…å‹: 'ğŸ”¥',
                        ç†æ™ºå‹: 'ğŸ§ ',
                        å¥‰çŒ®å‹: 'ğŸ',
                        ä¾èµ–å‹: 'ğŸ¤',
                        ç‹¬ç«‹å‹: 'ğŸŒ¿'
                    };
                    return emojis[dimension];
                },

                // è·å–é›·è¾¾å›¾èƒŒæ™¯ç‚¹
                getRadarPoints(radius) {
                    const centerX = 150;
                    const centerY = 150;
                    const angles = [-90, -18, 54, 126, 198]; // äº”ä¸ªç»´åº¦çš„è§’åº¦

                    return angles.map(angle => {
                        const radian = (angle * Math.PI) / 180;
                        const x = centerX + radius * Math.cos(radian);
                        const y = centerY + radius * Math.sin(radian);
                        return `${x},${y}`;
                    }).join(' ');
                },

                // è·å–ç”¨æˆ·å¾—åˆ†é›·è¾¾å›¾ç‚¹
                getUserRadarPoints() {
                    const centerX = 150;
                    const centerY = 150;
                    const maxRadius = 80; // æœ€å¤§åŠå¾„
                    const angles = [-90, -18, 54, 126, 198]; // äº”ä¸ªç»´åº¦çš„è§’åº¦
                    const dimensions = ['æ¿€æƒ…å‹', 'ç†æ™ºå‹', 'å¥‰çŒ®å‹', 'ä¾èµ–å‹', 'ç‹¬ç«‹å‹'];

                    return dimensions.map((dimension, index) => {
                        const score = this.result.dimensionScores[dimension];
                        const radius = (score / 20) * maxRadius; // æœ€å¤§å¾—åˆ†æ˜¯20
                        const angle = angles[index];
                        const radian = (angle * Math.PI) / 180;
                        const x = centerX + radius * Math.cos(radian);
                        const y = centerY + radius * Math.sin(radian);
                        return `${x},${y}`;
                    }).join(' ');
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
